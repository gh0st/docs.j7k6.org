I"ƒ<h2 id="problem">Problem</h2>
<p>Somewhere between <strong>FreeNAS</strong> 11.1 U6 and 11.2 U1, a change merged from <em>FreeBSD</em> (some kind of network throttling) results in <em>macOS</em> clients having problems with a significant drop in tranfer rates.</p>

<h2 id="solution">Solution</h2>
<p>Run <code class="highlighter-rouge">sysctl net.inet.tcp.reass.maxqueuelen=4096</code> in a FreeNAS shell.</p>

<p>To make the change permanent, go to <em>System</em> -&gt; <em>Tunables</em> in the FreeNAS WebUI.
Add a variable: <code class="highlighter-rouge">net.inet.tcp.reass.maxqueuelen</code> with value <code class="highlighter-rouge">4096</code> and type <code class="highlighter-rouge">Sysctl</code>.</p>

<hr />
<ol>
  <li><a href="https://forums.freenas.org/index.php?threads/11-1u6-update-transfer-aborts-on-smb-share-mac-client.69553/post-481046">https://forums.freenas.org/index.php?threads/11-1u6-update-transfer-aborts-on-smb-share-mac-client.69553/post-481046</a></li>
  <li><a href="https://www.freebsd.org/security/advisories/FreeBSD-SA-18:08.tcp.asc">https://www.freebsd.org/security/advisories/FreeBSD-SA-18:08.tcp.asc</a></li>
</ol>
:ET