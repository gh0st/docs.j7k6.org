I"T<ol>
  <li>Install packages:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt update
apt <span class="nb">install</span> <span class="nt">-y</span> dnscrypt-proxy tor
</code></pre></div>    </div>
  </li>
  <li>Edit <code class="highlighter-rouge">/etc/dnscrypt-proxy/dnscrypt-proxy.toml</code>:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>listen_address = ['127.0.0.1:53']
server_names = ['cloudflare']
proxy = 'socks5://127.0.0.1:9050'
force_tcp = true
</code></pre></div>    </div>
  </li>
  <li>Edit <code class="highlighter-rouge">/etc/resolv.conf</code>:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nameserver 127.0.0.1
</code></pre></div>    </div>
  </li>
  <li>Make <code class="highlighter-rouge">/etc/resolv.conf</code> immutable to prevent any changes made to it by <em>NetworkManager</em> (and others):
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chattr +i /etc/resolv.conf
</code></pre></div>    </div>
  </li>
  <li>Edit <code class="highlighter-rouge">/lib/systemd/system/dnscrypt-proxy.service</code>. Change <code class="highlighter-rouge">User=_dnscrypt-proxy</code> to <code class="highlighter-rouge">User=root</code>.
    <blockquote>
      <p><strong>Note</strong>: This is a dirty hack because the <code class="highlighter-rouge">dnscrypt-proxy</code> service refuses to listen on port <strong>53</strong> otherwise.</p>
    </blockquote>
  </li>
  <li>Enable and start the service:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl daemon-reload
systemctl <span class="nb">enable</span> <span class="nt">--now</span> dnscrypt-proxy.service
</code></pre></div>    </div>
  </li>
</ol>

<hr />
:ET