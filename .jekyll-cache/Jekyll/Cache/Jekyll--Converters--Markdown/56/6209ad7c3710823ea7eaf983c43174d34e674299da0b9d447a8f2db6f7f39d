I"¶<ol>
  <li>Install <strong>mitmproxy</strong>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>mitmproxy
</code></pre></div>    </div>
  </li>
  <li>Enable IP forwarding and <code class="highlighter-rouge">pf</code> redirection:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>sysctl <span class="nt">-w</span> net.inet.ip.forwarding<span class="o">=</span>1
<span class="nb">echo</span> <span class="s2">"rdr on en inet proto tcp to any port 80 -&gt; 127.0.0.1 port 8080"</span> | <span class="nb">sudo </span>pfctl <span class="nt">-v</span> <span class="nt">-ef</span> -
<span class="nb">echo</span> <span class="s2">"rdr on en2 inet proto tcp to any port 443 -&gt; 127.0.0.1 port 8080"</span> | <span class="nb">sudo </span>pfctl <span class="nt">-v</span> <span class="nt">-ef</span> -
</code></pre></div>    </div>
  </li>
  <li>Run <code class="highlighter-rouge">mitmproxy</code></li>
  <li>Send <code class="highlighter-rouge">~/.mitmproxy/mitmproxy-ca-cert.pem</code> to iPhone by mail &amp; install the certificate.</li>
  <li>Set <em>HTTP Proxy</em> in iPhone WLAN settings:
    <ul>
      <li><em>Server</em>: <code class="highlighter-rouge">&lt;$HOST_IP&gt;</code></li>
      <li><em>Port</em>: <code class="highlighter-rouge">8080</code></li>
    </ul>
  </li>
</ol>

<hr />
:ET